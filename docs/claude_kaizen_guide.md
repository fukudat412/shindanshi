# Claude Code カイゼン運用ガイド（診断士学習サイト）

このMDは「Claude Code（Web）」にリポジトリを繋いで、学習サイトを継続改善するための運用手順と、実際に投げる指示テンプレをまとめたものです。

---

## 0. このガイドの狙い
- 問題数が少ない不安を **「設計で解消」**する
- 1論点から問題を量産できる **テンプレ×制約** の仕組みにする
- Claudeに「勝手に作らせない」。**型に流し込ませる**

---

## 1. 改善の優先順位（迷ったらこれ）
1. **学習効率（復習キュー / 出題頻度の最適化）**
2. **問題生成の量産パイプライン（論点→テンプレ→問題）**
3. 管理画面（入稿・編集）
4. 見た目

---

## 2. リポジトリに最低限置くべきファイル
Claudeの暴走（仕様ブレ）を止めるために「正」を置く。

- `docs/PRD.md` … 要件の正本（MVP/制約/禁止事項）
- `docs/QUESTION_TEMPLATES.md` … 問題テンプレ集（後述）
- `docs/CONTENT_POLICY.md` … 著作権/引用ポリシー
- `docs/TODO.md` … 改善タスクの唯一の入口
- `docs/CHANGELOG.md` … 変更履歴（簡易でOK）

---

## 3. 問題を増やすための設計（Claudeにやらせる方針）
### 3.1 1論点 → 5〜7問に分解する（固定ルール）
各論点は最低でも以下の問題を揃える。

- 定義確認（○×/短文）
- 判断基準（4択）
- 手順の順序（並べ替え/選択）
- ありがちな誤解（ひっかけ4択）
- 逆方向（原因→結果、結果→原因）
- ミニケース（短い文章を読んで判断）
- 追加：二次接続（論点を言語化/助言化）

### 3.2 フェーズ（学習段階）をDBに持つ
問題を「難易度」だけでなく「学習フェーズ」で分ける。
- `phase = intro | understand | retain | exam`
- 同一論点でもフェーズが違えば別問題として成立する

### 3.3 出題頻度（SRS風）を入れて“少なくても足りる”体験にする
- 正答率が高い問題は頻度を下げる
- 間違えた問題は翌日/3日後/7日後に再出題
- 「今日やるべき5問」をトップで固定表示

---

## 4. Claudeに投げる「改善のやり方」
### 4.1 いつもこの順で進めさせる
1. 既存実装の把握（ディレクトリ構成/DB/画面）
2. PRDとTODOを確認してゴールを明確化
3. 変更設計（スキーマ/画面/ロジック）
4. 実装
5. 変更点の説明を `docs/CHANGELOG.md` に追記
6. 次の改善案を `docs/TODO.md` に追記

### 4.2 Claudeに「勝手に仕様追加させない」ための合言葉
指示の最後に毎回これを付ける。

- **「PRDに書いてない仕様追加は禁止。必要ならTODOに提案だけ書け。」**

---

## 5. Claude Code へ渡す指示テンプレ（コピペで使う）

### 5.1 “問題生成パイプライン” を作る指示（最優先）
```
docs/PRD.md と docs/QUESTION_TEMPLATES.md を読み、以下を実装してください。

目的：
- 1つの論点（topic）からテンプレに沿って問題を自動生成できるようにする
- 生成物はDBに登録できるJSONにする

要件：
- 問題に phase（intro/understand/retain/exam）を付ける
- 各論点あたり最低5問（定義/判断/手順/誤解/逆方向）を生成する
- 4択中心。計算問題はMVPでは作らない
- 各問に explanation（なぜ間違えるか含む）を必ず付ける
- 生成は管理画面 or CLIどちらでも良いが、再実行可能にする

制約：
- PRDに書いてない仕様追加は禁止。必要なら docs/TODO.md に提案だけ書くこと
- 著作権的に危険な転載は禁止（問題文の転載など）
```

### 5.2 “論点タグ付け” を強化する指示
```
現状の記事/クイズに対して、論点（topic）を付与して復習キューを作りやすくしてください。

要件：
- topics テーブル（またはenum）を導入して、articles/quizzes に紐付ける
- 既存データを壊さないmigrationを作る
- 管理画面で topic を付けられるUIを追加
- topic単位で「弱点ランキング（正答率）」をトップに表示
```

### 5.3 “復習キュー（少ない問題でも足りる体験）” を作る指示
```
復習キュー機能を実装してください。

要件：
- user_progress に last_answered_at, streak, next_review_at を持たせる（無ければ追加）
- 間違えたら next_review_at を翌日に設定
- 連続正解なら next_review_at を 3日→7日→14日 のように延ばす
- トップに「今日やるべき5問」を表示（next_review_at が今日以前のもの）
- 正答率80%以上の問題は出題頻度を下げる
```

### 5.4 “品質チェック（最低限）” を入れる指示
```
以下を追加してください。
- lint / typecheck のCI
- Prisma migrate deploy の運用が壊れてないか確認
- エラー時のログ出力（最低限）
PRDに書いてない仕様追加は禁止。必要ならTODOに提案だけ書いてください。
```

---

## 6. docs/QUESTION_TEMPLATES.md（そのまま置けるテンプレ案）
> これを別ファイルとして作っておくと、Claudeが量産しやすい。

### 一次（4択中心）
- 定義確認：○× / 短文
- 判断基準：4択
- 手順の順序：4択
- ありがちな誤解：ひっかけ4択
- 逆方向：原因→結果 / 結果→原因
- ミニケース：短文シナリオ→判断

### 二次（自己チェック型）
- 与件根拠：根拠箇所の選択/指摘
- 設問分解：問われている要素の列挙
- 骨子選択：最適な骨子を選ぶ
- NG指摘：ダメな理由を選ぶ

---

## 7. TODOの書き方（Claudeが実装しやすい粒度）
悪い例：
- 「問題を増やす」
良い例：
- 「topic=NPV を追加し、テンプレに沿って5問生成。DB登録まで。」
- 「user_progress に next_review_at を追加し、トップに今日の5問を出す」

---

## 8. 運用ルール（人間がやること）
- 1回のClaude作業は **PR1本** に収める
- PRのスコープは `docs/TODO.md` の1項目だけ
- レビュー観点はこれだけ
  - DB migration が安全か
  - 既存画面が壊れてないか
  - PRD逸脱がないか

---

## 9. 最初のおすすめ改善（順番）
1. topics導入（論点管理）
2. 復習キュー（少なくても足りる体験）
3. テンプレに沿った問題生成（量産）
4. 管理画面の入稿UX

---

## 10. すぐ使う「最初の一投」
```
docs/PRD.md とこの docs/CLAUDE_KAIZEN_GUIDE.md を読み、
TODOに「topics導入→復習キュー→問題生成」の3ステップを提案し、
最初のステップ（topics導入）だけを実装してください。
PRDに書いてない仕様追加は禁止。必要ならTODOに提案だけ書いてください。
```
